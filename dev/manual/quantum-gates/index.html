<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum gates · MyJuliVQC.jl</title><meta name="title" content="Quantum gates · MyJuliVQC.jl"/><meta property="og:title" content="Quantum gates · MyJuliVQC.jl"/><meta property="twitter:title" content="Quantum gates · MyJuliVQC.jl"/><meta name="description" content="Documentation for MyJuliVQC.jl."/><meta property="og:description" content="Documentation for MyJuliVQC.jl."/><meta property="twitter:description" content="Documentation for MyJuliVQC.jl."/><meta property="og:url" content="https://HanDirac.github.io/MyJuliVQC.jl/manual/quantum-gates/"/><meta property="twitter:url" content="https://HanDirac.github.io/MyJuliVQC.jl/manual/quantum-gates/"/><link rel="canonical" href="https://HanDirac.github.io/MyJuliVQC.jl/manual/quantum-gates/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MyJuliVQC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting-started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting-started/quick-start/">Quick Start</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../initialize-state/">Initialize a quantum state</a></li><li class="is-active"><a class="tocitem" href>Quantum gates</a><ul class="internal"><li><a class="tocitem" href="#Matrix-Element-Convention-for-QuantumGate"><span>Matrix Element Convention for <code>QuantumGate</code></span></a></li><li><a class="tocitem" href="#Built-in-Quantum-Gates"><span>Built-in Quantum Gates</span></a></li><li><a class="tocitem" href="#Controlled-Gates"><span>Controlled Gates</span></a></li><li><a class="tocitem" href="#Parametric-Quantum-Gates"><span>Parametric Quantum Gates</span></a></li><li><a class="tocitem" href="#Examples:-Non-Parametric-and-Parametric-Gates"><span>Examples: Non-Parametric and Parametric Gates</span></a></li></ul></li><li><a class="tocitem" href="../noise-channels/">Noise channels</a></li><li><a class="tocitem" href="../circuits/">Manipulating and running circuits</a></li><li><a class="tocitem" href="../qubit-operators/">Qubit operators</a></li><li><a class="tocitem" href="../automatic-differentiation/">Automatic differentiation</a></li><li><a class="tocitem" href="../threading-control/">Threading control (MyJuliVQC)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/vqc-example/">Creating a Variational Quantum Circuit</a></li><li><a class="tocitem" href="../../examples/gd-example/">A Simple Application of Gradient Descent</a></li><li><a class="tocitem" href="../../examples/utilities/">Utility Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Quantum gates</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quantum gates</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/HanDirac/MyJuliVQC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/HanDirac/MyJuliVQC.jl/blob/main/docs/src/manual/quantum-gates.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Quantum-Gates"><a class="docs-heading-anchor" href="#Quantum-Gates">Quantum Gates</a><a id="Quantum-Gates-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Gates" title="Permalink"></a></h1><p>The second step of using <strong>MyJuliVQC</strong> is to build a quantum circuit, which requires specifying the elementary quantum gate operations (and, for noisy circuits, quantum channels).</p><p>The most general way to define a quantum gate in MyJuliVQC is via the constructor</p><p><code>QuantumGate(positions, data)</code></p><p>where:</p><ul><li><code>positions</code> specifies the qubit indices that the gate acts on, e.g. <code>(1, 3)</code> for a two-qubit gate on qubits 1 and 3;</li><li><code>data</code> is the raw matrix of the gate, which should be a unitary matrix of size <code>2^k × 2^k</code> for a <code>k</code>-qubit gate.</li></ul><p>Internally, MyJuliVQC uses <strong>column-major</strong> ordering (Julia’s default) for storing gate matrices and state data.</p><h2 id="Matrix-Element-Convention-for-QuantumGate"><a class="docs-heading-anchor" href="#Matrix-Element-Convention-for-QuantumGate">Matrix Element Convention for <code>QuantumGate</code></a><a id="Matrix-Element-Convention-for-QuantumGate-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-Element-Convention-for-QuantumGate" title="Permalink"></a></h2><p>More specifically, suppose <code>QuantumGate(positions, data)</code> (where <span>$\texttt{positions} = (j_1, j_2, \dots, j_l)$</span>) represents an operator <span>$\hat{O}$</span> acting on the Hilbert subspace associated with the qubits <span>${j_1}, {j_2}, \ldots, {j_l}$</span>. Let <span>$|x_{j_1}=k_1,\space x_{j_2}=k_2,\space \cdots, \space x_{j_l}=k_l\rangle$</span> denote a computational basis vector in this Hilbert space. Then </p><p class="math-container">\[\texttt{data}[a,b]
=
\langle
x_{j_1}=a_1,x_{j_2}=a_2,\dots,x_{j_l}=a_l
\mid
\hat{O}
\mid
x_{j_1}=b_1,x_{j_2}=b_2,\dots,x_{j_l}=b_l
\rangle,\]</p><p>where <span>$a,b \in {1,2,\dots,2^l}$</span>, and the binary expansions of <span>$(a-1)$</span> and <span>$(b-1)$</span> correspond to <span>$(a_l,\dots,a_2,a_1)$</span> and <span>$(b_l,\dots,b_2,b_1)$</span>, respectively.</p><p>As a concrete example, consider a two-qubit controlled gate whose control qubit is the 2nd qubit and target qubit is the 4th qubit. If we take <code>positions = (2,4)</code> then the corresponding <code>data</code> matrix can be written as  <span>$\texttt{data} = \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; u_{11} &amp; 0 &amp; u_{12} \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; u_{21} &amp; 0 &amp; u_{22} \end{pmatrix},$</span> where <span>$\begin{pmatrix} u_{11} &amp; u_{12} \\ u_{21} &amp; u_{22} \end{pmatrix}$</span> denotes the single-qubit unitary acting on the target qubit when the control qubit takes the value <span>$1$</span>.</p><p>If we swap the order of <code>positions</code>, i.e. take <code>positions} = (4,2)</code>, then <code>data</code> should instead be written as <span>$\texttt{data} = \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; u_{11} &amp; u_{12} \\
0 &amp; 0 &amp; u_{21} &amp; u_{22} \end{pmatrix},$</span></p><p>If we change the control qubit of this two-qubit controlled gate to be the 4th qubit and the target qubit to be the 2nd qubit, then we may set <span>$\texttt{positions}=(4,2),\space \texttt{data} = \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; u_{11} &amp; 0 &amp; u_{12} \\
0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; u_{21} &amp; 0 &amp; u_{22} \end{pmatrix},$</span> or <span>$\texttt{positions}=(2,4),\space \texttt{data} = \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; u_{11} &amp; u_{12} \\
0 &amp; 0 &amp; u_{21} &amp; u_{22} \end{pmatrix}.$</span></p><hr/><h2 id="Built-in-Quantum-Gates"><a class="docs-heading-anchor" href="#Built-in-Quantum-Gates">Built-in Quantum Gates</a><a id="Built-in-Quantum-Gates-1"></a><a class="docs-heading-anchor-permalink" href="#Built-in-Quantum-Gates" title="Permalink"></a></h2><p>For convenience, MyJuliVQC also provides named constructors for commonly used quantum gates:</p><p><code>XGate</code>, <code>YGate</code>, <code>ZGate</code>, <code>SGate</code>, <code>HGate</code>, <code>sqrtXGate</code>, <code>sqrtYGate</code>, <code>TGate</code>, <code>SWAPGate</code>, <code>iSWAPGate</code>, <code>CZGate</code>, <code>CNOTGate</code>, <code>TOFFOLIGate</code>, <code>FREDKINGate</code>, <code>RxGate</code>, <code>RyGate</code>,<code>RzGate</code>, <code>CRxGate</code>, <code>CRyGate</code>, <code>CRzGate</code>, <code>FSIMGate</code>. </p><p>Note:</p><ul><li>For parameter-free single-qubit gates such as <code>XGate</code>, <code>YGate</code>, <code>ZGate</code>, <code>SGate</code>, <code>HGate</code>, <code>sqrtXGate</code>, <code>sqrtYGate</code> and <code>TGate</code>, please refer to the usage of <code>XGate</code> in the <strong>Examples</strong> section below.</li><li>For parameter-free two-qubit gates such as <code>SWAPGate</code>, <code>iSWAPGate</code>, <code>CZGate</code> and  <code>CNOTGate</code>, please refer to the usage of <code>CNOTGate</code> in the <strong>Examples</strong> section below.</li><li>For parameter-free three-qubit gates such as <code>TOFFOLIGate</code> and <code>FREDKINGate</code>, please refer to the usage of <code>TOFFOLIGate</code> in the <strong>Examples</strong> section below.</li><li>For <code>RxGate</code>, <code>RyGate</code>, and <code>RzGate</code>, please refer to the usage of <code>RxGate</code> in the <strong>Examples</strong> section.</li><li>For <code>CRxGate</code>, <code>CRyGate</code>, and <code>CRzGate</code>, please refer to the usage of <code>CRxGate</code> in the <strong>Examples</strong> section.</li><li>For <code>FSIMGate</code>, please refer to the <strong>Examples</strong> section.</li><li>For <code>CNOTGate</code>, <code>CRxGate</code>, <code>CRyGate</code>, and <code>CRzGate</code>, the first element in <code>positions</code> specifies the control qubit, and the second element specifies the target qubit.</li><li>For <code>TOFFOLIGate</code>, the first, second, and third elements in <code>positions</code> specify the first control qubit, second control qubit, and target qubit, respectively.</li><li>For <code>FREDKINGate</code>, the first, second, and third elements in <code>positions</code> specify the control qubit, first target qubit, and second target qubit, respectively.</li><li>For <code>FSIMGate</code>, the first parameter is <span>$\theta$</span>, the second parameter is <span>$\phi$</span>, and</li></ul><p class="math-container">\[\texttt{data}
=
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \cos(\theta) &amp; -i\sin(\theta) &amp; 0 \\
0 &amp; -i\sin(\theta) &amp; \cos(\theta) &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; e^{-i\phi}
\end{pmatrix}.\]</p><p>In the current implementation of <strong>MyJuliVQC</strong>, these special gates are implemented as thin wrappers around the generic <code>QuantumGate</code> constructor. This design keeps the code transparent and easy to read. Future versions may introduce specialized, highly optimized kernels for some of these gates, but the public API will remain the same.</p><hr/><h2 id="Controlled-Gates"><a class="docs-heading-anchor" href="#Controlled-Gates">Controlled Gates</a><a id="Controlled-Gates-1"></a><a class="docs-heading-anchor-permalink" href="#Controlled-Gates" title="Permalink"></a></h2><p>MyJuliVQC supports generic controlled operations via dedicated constructors:</p><ul><li><p><code>CONTROLGate(i, j, data)</code>: a controlled single-qubit gate  </p><ul><li><code>i</code>: control qubit  </li><li><code>j</code>: target qubit  </li><li><code>data</code>: the <code>2×2</code> matrix of the target single-qubit operation</li></ul></li><li><p><code>CONTROLCONTROLGate(i, j, k, data)</code>: a doubly controlled single-qubit gate  </p><ul><li><code>i</code>, <code>j</code>: control qubits  </li><li><code>k</code>: target qubit  </li><li><code>data</code>: again the <code>2×2</code> matrix acting on the target qubit</li></ul></li></ul><p>These constructors are convenient when you want to promote an arbitrary single-qubit gate to a (multi-)controlled version without manually building the full <code>2^n × 2^n</code> matrix.</p><hr/><h2 id="Parametric-Quantum-Gates"><a class="docs-heading-anchor" href="#Parametric-Quantum-Gates">Parametric Quantum Gates</a><a id="Parametric-Quantum-Gates-1"></a><a class="docs-heading-anchor-permalink" href="#Parametric-Quantum-Gates" title="Permalink"></a></h2><p>Many variational algorithms require <strong>parameterized gates</strong>.   In MyJuliVQC, such gates follow a unified interface</p><p><code>G(i..., paras; isparas)</code></p><p>where:</p><ul><li><code>G</code> is a gate constructor such as <code>RxGate</code>, <code>RyGate</code>, <code>RzGate</code>, <code>FSIMGate</code>, etc.;</li><li><code>i...</code> are the qubit indices;</li><li><code>paras</code> is either:<ul><li>a single scalar (for one-parameter gates), or</li><li>an array of scalars (for multi-parameter gates);</li></ul></li><li><code>isparas</code> is a Boolean keyword:<ul><li><code>isparas = false</code>: the gate is treated as a <strong>fixed</strong> numerical gate;</li><li><code>isparas = true</code>: the gate is treated as having <strong>optimizable parameters</strong>, and its parameters will be tracked by the variational/gradient engine.</li></ul></li></ul><hr/><h2 id="Examples:-Non-Parametric-and-Parametric-Gates"><a class="docs-heading-anchor" href="#Examples:-Non-Parametric-and-Parametric-Gates">Examples: Non-Parametric and Parametric Gates</a><a id="Examples:-Non-Parametric-and-Parametric-Gates-1"></a><a class="docs-heading-anchor-permalink" href="#Examples:-Non-Parametric-and-Parametric-Gates" title="Permalink"></a></h2><p>The following code illustrates how to construct basic non-parametric and parametric gates in MyJuliVQC:</p><pre><code class="language-julia hljs">using MyJuliVQC

# Single-qubit X gate on qubit 1
n = 1
X = XGate(n)

# Two-qubit CNOT: control = 1, target = 2
ncontrol = 1
ntarget  = 2
CNOT = CNOTGate(ncontrol, ntarget)

# Rx gate: non-parametric vs parametric
θ = π / 2

# a non-parametric Rx gate (angle fixed, not tracked as a variational parameter)
non_para_Rx = RxGate(n, θ; isparas = false)

# a parametric Rx gate (its angle is treated as a variational parameter)
para_Rx = RxGate(n, θ; isparas = true)

# Toffoli gate (CCNOT)
c1 = 3
c2 = 2
tgt = 4
Toffoli = TOFFOLIGate(c1, c2, tgt)

# FSIM Gate
non_para_fsim = FSIMGate(2, 3, pi/4, pi/3; isparas=[false, false])
para_fsim_1 = FSIMGate(4, 5, pi/6, pi/4; isparas=[true, false])
para_fsim_2 = FSIMGate(3, 5, pi/9, pi/40; isparas=[false, true])
para_fsim_3 = FSIMGate(5, 3, pi/10, pi/33; isparas=[true, true])</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../initialize-state/">« Initialize a quantum state</a><a class="docs-footer-nextpage" href="../noise-channels/">Noise channels »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 18 January 2026 04:04">Sunday 18 January 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
